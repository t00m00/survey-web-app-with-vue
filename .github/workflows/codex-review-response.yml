name: Codex CLI review response

on:
  pull_request_review:
    types: [submitted]

permissions:
  contents: write
  issues: write
  pull-requests: write
  actions: write

jobs:
  review-response:
    name: ãƒ¬ãƒ“ãƒ¥ãƒ¼å¿œç­”å‡¦ç†
    runs-on: ubuntu-latest
    if: |
      contains(github.event.review.body, '@codex')

    steps:
      - name: ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ
        uses: actions/checkout@v4

      - name: ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚³ãƒ¡ãƒ³ãƒˆã«å¿œç­”
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          REVIEW_BODY="${{ github.event.review.body }}"
          PR_NUMBER=${{ github.event.pull_request.number }}

          cat > response.md << 'EOF'
          ## ğŸ¤– Codex ãƒ¬ãƒ“ãƒ¥ãƒ¼å¿œç­”

          ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼

          **ãƒ¬ãƒ“ãƒ¥ãƒ¼å†…å®¹:**
          ${REVIEW_BODY}

          **å¯¾å¿œæ–¹é‡:**
          ã”æŒ‡æ‘˜ã„ãŸã ã„ãŸç‚¹ã«ã¤ã„ã¦ç¢ºèªã—ã€å¿…è¦ã«å¿œã˜ã¦ä¿®æ­£ã„ãŸã—ã¾ã™ã€‚
          è¿½åŠ ã®@codexãƒ¬ãƒ“ãƒ¥ãƒ¼è¦æ±‚ãŒã‚ã‚Šã¾ã—ãŸã‚‰ã€ã‚³ãƒ¡ãƒ³ãƒˆã§ãŠçŸ¥ã‚‰ã›ãã ã•ã„ã€‚

          ---
          *ã“ã®å¿œç­”ã¯Codex CLIã«ã‚ˆã£ã¦è‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã—ãŸ*
          EOF

          gh pr comment ${PR_NUMBER} --body-file response.md
